<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHIU Swap - Mint & Redeem</title>
    <link rel="icon" type="image/png" href="https://www.woofswap.finance/image/tokens/sou.png">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #667eea;
            --primary-light: #8b9eff;
            --primary-dark: #5568d3;
            --accent: #764ba2;
            --accent-light: #9b7ec4;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --dark-1: #0a0e27;
            --dark-2: #0f1629;
            --dark-3: #1a1f3a;
            --dark-4: #232d4d;
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;
            --border: #334155;
            --border-light: #475569;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, var(--dark-1) 0%, var(--dark-2) 50%, var(--dark-3) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }

        /* Background animation */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(118, 75, 162, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
            padding: 16px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
        }

        .logo-nav {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 800;
            color: var(--text-primary);
            text-decoration: none;
        }

        .logo-nav img {
            width: 32px;
            height: 32px;
            border-radius: 8px;
        }

        .nav-links {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: var(--transition);
        }

        .nav-links a:hover {
            color: var(--primary-light);
        }

        .wallet-button {
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
            font-family: 'Outfit', sans-serif;
        }

        .wallet-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            nav {
                padding: 12px 20px;
            }

            .nav-links {
                gap: 20px;
            }

            .nav-links a {
                font-size: 12px;
            }
        }

        /* Main content wrapper */
        .wrapper {
            position: relative;
            z-index: 1;
            padding-top: 80px;
            flex: 1;
        }

        /* Hero Section */
        .hero {
            padding: 80px 40px;
            text-align: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-content {
            margin-bottom: 60px;
        }

        .hero-badge {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(102, 126, 234, 0.15);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: var(--primary-light);
            margin-bottom: 20px;
            letter-spacing: 0.5px;
        }

        .hero h1 {
            font-size: 56px;
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 18px;
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 40px;
            line-height: 1.6;
        }

        /* Swap Container */
        .swap-container {
            max-width: 560px;
            margin: 0 auto;
            padding: 0 40px 80px;
        }

        .swap-card {
            background: rgba(26, 31, 58, 0.85);
            backdrop-filter: blur(30px);
            border-radius: 24px;
            box-shadow: 
                0 30px 60px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.15);
            overflow: hidden;
        }

        .swap-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .swap-header::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.2) 0%, transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(255, 255, 255, 0.1) 0%, transparent 40%);
            pointer-events: none;
        }

        .swap-header-content {
            position: relative;
            z-index: 1;
        }

        .swap-title {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .swap-subtitle {
            font-size: 13px;
            opacity: 0.9;
            font-weight: 500;
        }

        .swap-content {
            padding: 40px;
        }

        /* Mode Tabs */
        .mode-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 20px;
        }

        .mode-tab {
            flex: 1;
            padding: 12px 16px;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Outfit', sans-serif;
            font-size: 14px;
        }

        .mode-tab.active {
            color: var(--primary-light);
            border-bottom-color: var(--primary);
        }

        .mode-tab:hover:not(.active) {
            color: var(--text-primary);
        }

        /* Input Section */
        .input-section {
            margin-bottom: 24px;
        }

        .input-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .balance-display {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .input-box {
            background: rgba(35, 45, 77, 0.6);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: var(--transition);
        }

        .input-box:focus-within {
            border-color: var(--primary);
            background: rgba(102, 126, 234, 0.08);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .token-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 7px 11px;
            background: rgba(102, 126, 234, 0.15);
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 700;
            font-size: 13px;
            color: var(--text-primary);
        }

        .token-selector:hover {
            background: rgba(102, 126, 234, 0.25);
        }

        input[type="number"] {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 700;
            outline: none;
            font-family: 'Space Mono', monospace;
        }

        input[type="number"]::placeholder {
            color: var(--text-tertiary);
        }

        /* Arrow Section */
        .arrow-section {
            display: flex;
            justify-content: center;
            margin: 24px 0;
        }

        .arrow-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(102, 126, 234, 0.15);
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: var(--primary-light);
            font-size: 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Action Button */
        .action-button {
            width: 100%;
            padding: 16px 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
            margin-bottom: 14px;
            font-family: 'Outfit', sans-serif;
        }

        .action-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
        }

        .action-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Message Section */
        .message-section {
            padding: 13px 15px;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 11px;
            font-size: 12px;
            color: var(--primary-light);
            text-align: center;
            min-height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            word-break: break-all;
        }

        .message-section.success {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
            color: var(--success);
        }

        .message-section.error {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: var(--error);
        }

        .message-section.warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: rgba(245, 158, 11, 0.3);
            color: var(--warning);
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, rgba(10, 14, 39, 0.95) 0%, rgba(15, 22, 41, 0.95) 100%);
            border-top: 1px solid rgba(102, 126, 234, 0.1);
            padding: 60px 40px;
            margin-top: auto;
            position: relative;
            z-index: 1;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-bottom {
            font-size: 12px;
            color: var(--text-tertiary);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <a href="#" class="logo-nav">
            <span>ðŸª™</span>
            <span>SHIU Swap</span>
        </a>
        <div class="nav-links">
            <button class="wallet-button" id="connectWalletBtn" onclick="connectWallet()">Connect Wallet</button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="wrapper">
        <section class="hero">
            <div class="hero-content">
                <div class="hero-badge">Ethereum Network</div>
                <h1>SHIU Swap</h1>
                <p>Seamlessly mint SHIU with USDT or USDC, and redeem back anytime. All tokens use 6-decimal precision.</p>
            </div>
        </section>

        <!-- Swap Section -->
        <section id="swap">
            <div class="swap-container">
                <div class="swap-card">
                    <div class="swap-header">
                        <div class="swap-header-content">
                            <div class="swap-title">SHIU Swap</div>
                            <div class="swap-subtitle">Mint or Redeem SHIU (6 Decimals)</div>
                        </div>
                    </div>

                    <div class="swap-content">
                        <!-- Mode Selection -->
                        <div class="mode-tabs">
                            <button class="mode-tab active" id="mintTab" onclick="switchMode('mint')">Mint</button>
                            <button class="mode-tab" id="redeemTab" onclick="switchMode('redeem')">Redeem</button>
                        </div>

                        <!-- Mint Mode -->
                        <div id="mintMode" class="mode-content">
                            <div class="input-section">
                                <div class="input-label">
                                    <span>From</span>
                                    <span class="balance-display" id="fromBalance">Balance: 0.0000</span>
                                </div>
                                <div class="input-box">
                                    <input type="number" id="fromAmount" placeholder="0.0" step="0.0001" min="0" oninput="updateToAmount()">
                                    <select id="fromToken" class="token-selector" onchange="updateBalance(); updateToAmount()">
                                        <option value="USDT">USDT</option>
                                        <option value="USDC">USDC</option>
                                    </select>
                                </div>
                            </div>
                            <div class="arrow-section"><div class="arrow-button">â†“</div></div>
                            <div class="input-section">
                                <div class="input-label">
                                    <span>To</span>
                                    <span class="balance-display" id="shiuBalance">Balance: 0.0000</span>
                                </div>
                                <div class="input-box">
                                    <input type="number" id="toAmount" placeholder="0.0" readonly>
                                    <div class="token-selector"><span>SHIU</span></div>
                                </div>
                            </div>
                            <button class="action-button" id="mintButton" onclick="executeMint()" disabled>Mint SHIU</button>
                            <div class="message-section" id="messageSection">Connect wallet to start</div>
                        </div>

                        <!-- Redeem Mode -->
                        <div id="redeemMode" class="mode-content" style="display: none;">
                            <div class="input-section">
                                <div class="input-label">
                                    <span>From</span>
                                    <span class="balance-display" id="redeemFromBalance">Balance: 0.0000</span>
                                </div>
                                <div class="input-box">
                                    <input type="number" id="redeemAmount" placeholder="0.0" step="0.0001" min="0" oninput="updateRedeemOutput()">
                                    <div class="token-selector"><span>SHIU</span></div>
                                </div>
                            </div>
                            <div class="arrow-section"><div class="arrow-button">â†“</div></div>
                            <div class="input-section">
                                <div class="input-label">
                                    <span>To</span>
                                    <span class="balance-display" id="redeemToBalance">Balance: 0.0000</span>
                                </div>
                                <div class="input-box">
                                    <input type="number" id="redeemOutputAmount" placeholder="0.0" readonly>
                                    <select id="redeemToken" class="token-selector" onchange="updateBalance(); updateRedeemOutput()">
                                        <option value="USDT">USDT</option>
                                        <option value="USDC">USDC</option>
                                    </select>
                                </div>
                            </div>
                            <button class="action-button" id="redeemButton" onclick="executeRedeem()" disabled>Redeem</button>
                            <div class="message-section" id="redeemMessageSection">Connect wallet to start</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-bottom">
                <p>Â© 2024 SHIU Swap. Secure 6-Decimal Stablecoin Bridge.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
    <script>
        const SHIU_CONTRACT_ADDRESS = '0x393a0Ff130702C2dC6BFC500368394953450765f';
        const TOKEN_ADDRESSES = {
            USDT: '0xdAC17F958D2ee523a2206206994597C13D831ec7',
            USDC: '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48'
        };

        const SHIU_ABI = [
            {"inputs":[{"name":"amount","type":"uint256"}],"name":"mintWithUSDT","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"name":"amount","type":"uint256"}],"name":"mintWithUSDC","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"name":"shiuAmount","type":"uint256"}],"name":"redeemToUSDT","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"name":"shiuAmount","type":"uint256"}],"name":"redeemToUSDC","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"stateMutability":"view","type":"function"}
        ];

        const ERC20_ABI = [
            {"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"type":"function"},
            {"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_value","type":"uint256"}],"name":"approve","outputs":[{"name":"","type":"bool"}],"type":"function"},
            {"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"","type":"uint256"}],"type":"function"}
        ];

        let web3, userAccount, shiuContract, usdtContract, usdcContract, currentMode = 'mint';

        async function connectWallet() {
            if (!window.ethereum) return showMessage('Please install MetaMask', 'error');
            try {
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                userAccount = accounts[0];
                web3 = new Web3(window.ethereum);
                shiuContract = new web3.eth.Contract(SHIU_ABI, SHIU_CONTRACT_ADDRESS);
                usdtContract = new web3.eth.Contract(ERC20_ABI, TOKEN_ADDRESSES.USDT);
                usdcContract = new web3.eth.Contract(ERC20_ABI, TOKEN_ADDRESSES.USDC);
                document.getElementById('connectWalletBtn').textContent = userAccount.substring(0, 6) + '...' + userAccount.substring(38);
                document.getElementById('mintButton').disabled = false;
                document.getElementById('redeemButton').disabled = false;
                await updateBalance();
                showMessage('Wallet connected', 'success');
            } catch (e) { showMessage(e.message, 'error'); }
        }

        async function updateBalance() {
            if (!userAccount) return;
            try {
                // All tokens use 6 decimals (mwei)
                const usdtRaw = await usdtContract.methods.balanceOf(userAccount).call();
                const usdcRaw = await usdcContract.methods.balanceOf(userAccount).call();
                const shiuRaw = await shiuContract.methods.balanceOf(userAccount).call();
                
                const usdt = web3.utils.fromWei(usdtRaw, 'mwei');
                const usdc = web3.utils.fromWei(usdcRaw, 'mwei');
                const shiu = web3.utils.fromWei(shiuRaw, 'mwei');

                const fromToken = document.getElementById('fromToken').value;
                document.getElementById('fromBalance').textContent = `Balance: ${parseFloat(fromToken === 'USDT' ? usdt : usdc).toFixed(4)}`;
                document.getElementById('shiuBalance').textContent = `Balance: ${parseFloat(shiu).toFixed(4)}`;
                document.getElementById('redeemFromBalance').textContent = `Balance: ${parseFloat(shiu).toFixed(4)}`;
                
                const redeemToken = document.getElementById('redeemToken').value;
                document.getElementById('redeemToBalance').textContent = `Balance: ${parseFloat(redeemToken === 'USDT' ? usdt : usdc).toFixed(4)}`;
            } catch (e) { console.error(e); }
        }

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('mintTab').classList.toggle('active', mode === 'mint');
            document.getElementById('redeemTab').classList.toggle('active', mode === 'redeem');
            document.getElementById('mintMode').style.display = mode === 'mint' ? 'block' : 'none';
            document.getElementById('redeemMode').style.display = mode === 'redeem' ? 'block' : 'none';
            updateBalance();
        }

        function updateToAmount() { document.getElementById('toAmount').value = document.getElementById('fromAmount').value; }
        function updateRedeemOutput() { document.getElementById('redeemOutputAmount').value = document.getElementById('redeemAmount').value; }

        async function executeMint() {
            const amount = document.getElementById('fromAmount').value;
            if (!amount || amount <= 0) return showMessage('Enter valid amount', 'error');
            const fromToken = document.getElementById('fromToken').value;
            const amountWei = web3.utils.toWei(amount, 'mwei');
            try {
                showMessage('Checking allowance...', 'warning');
                const tokenContract = fromToken === 'USDT' ? usdtContract : usdcContract;
                const allowance = await tokenContract.methods.allowance(userAccount, SHIU_CONTRACT_ADDRESS).call();
                if (BigInt(allowance) < BigInt(amountWei)) {
                    showMessage('Approving...', 'warning');
                    await tokenContract.methods.approve(SHIU_CONTRACT_ADDRESS, amountWei).send({ from: userAccount });
                }
                showMessage('Minting...', 'warning');
                const method = fromToken === 'USDT' ? 'mintWithUSDT' : 'mintWithUSDC';
                await shiuContract.methods[method](amountWei).send({ from: userAccount });
                showMessage('Mint success!', 'success');
                updateBalance();
            } catch (e) { showMessage(e.message, 'error'); }
        }

        async function executeRedeem() {
            const amount = document.getElementById('redeemAmount').value;
            if (!amount || amount <= 0) return showMessage('Enter valid amount', 'error');
            const redeemToken = document.getElementById('redeemToken').value;
            const amountWei = web3.utils.toWei(amount, 'mwei');
            try {
                showMessage('Redeeming...', 'warning');
                const method = redeemToken === 'USDT' ? 'redeemToUSDT' : 'redeemToUSDC';
                await shiuContract.methods[method](amountWei).send({ from: userAccount });
                showMessage('Redeem success!', 'success');
                updateBalance();
            } catch (e) { showMessage(e.message, 'error'); }
        }

        function showMessage(msg, type) {
            const el = currentMode === 'mint' ? document.getElementById('messageSection') : document.getElementById('redeemMessageSection');
            el.textContent = msg; el.className = 'message-section ' + type;
        }
    </script>
</body>
</html>
